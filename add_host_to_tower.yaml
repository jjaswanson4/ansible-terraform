---

- name: add a host to tower inventory
  hosts:
    - localhost
  gather_facts: false
  vars:
    ansible_connection: local
  tasks:
    - name: create host in tower inventory
      ansible.tower.tower_host:
        tower_host: "{{ lookup('env', 'TOWER_HOST') }}"
        tower_username: "{{ lookup('env', 'TOWER_USERNAME') }}"
        tower_password: "{{ lookup('env', 'TOWER_PASSWORD') }}"
        validate_certs: "{{ lookup('env', 'TOWER_VALIDATE_CERTS') | default(false), true) }}"
        name: "{{ hostname }}"
        inventory: "{{ tower_inventory }}"
        variables: "{{ host_variables }}"
